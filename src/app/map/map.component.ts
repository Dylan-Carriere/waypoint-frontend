import { Component, OnInit } from '@angular/core';
import { environment } from '../../environments/environment';
import * as mapboxgl from 'mapbox-gl';

@Component({
  selector: 'app-map',
  templateUrl: './map.component.html',
  styleUrls: ['./map.component.css']
})
export class MapComponent implements OnInit {
  map: mapboxgl.Map;
  style = 'mapbox://styles/mapbox/streets-v11';
  lat = 43.63085694273947;
  lng = 1.3628196716308594;

  constructor() { }

  ngOnInit(): void {

    this.map = new mapboxgl.Map({
        accessToken: environment.mapbox.accessToken,
        container: 'map',
        style: this.style,
        zoom: 12,
        center: [this.lng, this.lat]
    });
    // Add map controls
    this.map.addControl(new mapboxgl.NavigationControl());

    this.map.on('load', function () {
      this.addSource('toulouseAirport', {
        'type': 'geojson',
        'data':{
          "type": "FeatureCollection",
          "features": [
            {
              "type": "Feature",
              "properties": {},
              "geometry": {
                "type": "Polygon",
                "coordinates": [
                  [
                    [
                      1.3399887084960938,
                      43.65060921788041
                    ],
                    [
                      1.3361263275146484,
                      43.64675865498884
                    ],
                    [
                      1.3376712799072266,
                      43.644212179418545
                    ],
                    [
                      1.3425636291503906,
                      43.641976160645555
                    ],
                    [
                      1.3465118408203123,
                      43.63750387342734
                    ],
                    [
                      1.3458251953125,
                      43.63588879900987
                    ],
                    [
                      1.3476276397705078,
                      43.63731752090232
                    ],
                    [
                      1.3596439361572266,
                      43.6256382764122
                    ],
                    [
                      1.3558673858642578,
                      43.62365009386727
                    ],
                    [
                      1.3580131530761719,
                      43.621848246638415
                    ],
                    [
                      1.3655662536621094,
                      43.621723979321644
                    ],
                    [
                      1.3659095764160156,
                      43.61749873772273
                    ],
                    [
                      1.3688278198242188,
                      43.616069544688195
                    ],
                    [
                      1.3706302642822263,
                      43.61557242610505
                    ],
                    [
                      1.372518539428711,
                      43.6146403176848
                    ],
                    [
                      1.3726043701171875,
                      43.613708194816596
                    ],
                    [
                      1.375007629394531,
                      43.61296248611951
                    ],
                    [
                      1.3794708251953125,
                      43.61246534185104
                    ],
                    [
                      1.3838481903076172,
                      43.61240319852854
                    ],
                    [
                      1.3868522644042969,
                      43.61439175299932
                    ],
                    [
                      1.3895988464355469,
                      43.62060556191227
                    ],
                    [
                      1.3816165924072266,
                      43.623028773336955
                    ],
                    [
                      1.3813591003417969,
                      43.62222104704757
                    ],
                    [
                      1.3798141479492188,
                      43.62265597793652
                    ],
                    [
                      1.376810073852539,
                      43.6257004060572
                    ],
                    [
                      1.377410888671875,
                      43.627999157779136
                    ],
                    [
                      1.3762092590332031,
                      43.629241689675126
                    ],
                    [
                      1.3767242431640623,
                      43.62949019297204
                    ],
                    [
                      1.3723468780517578,
                      43.6324100297489
                    ],
                    [
                      1.3697719573974607,
                      43.63408731864001
                    ],
                    [
                      1.3649654388427734,
                      43.63682057801007
                    ],
                    [
                      1.364278793334961,
                      43.636447868143804
                    ],
                    [
                      1.3611888885498047,
                      43.63942948234441
                    ],
                    [
                      1.3661670684814453,
                      43.642100386094064
                    ],
                    [
                      1.360330581665039,
                      43.644212179418545
                    ],
                    [
                      1.3510608673095703,
                      43.64564070339714
                    ],
                    [
                      1.3399887084960938,
                      43.65060921788041
                    ]
                  ]
                ]
              }
            }
          ]
        }
      });

      this.addLayer({
        'id': 'toulouseAirport-layer',
        'type': 'fill',
        'source': 'toulouseAirport',
        'layout': {},
        'paint': {
          'fill-color': '#4682B4',
          'fill-opacity': 0.8
          }
        });
      });
  }

}
